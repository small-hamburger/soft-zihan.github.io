# 04-D. ç»„ä»¶è®¾è®¡æ¨¡å¼ ğŸ—ï¸

> **å­¦ä¹ ç›®æ ‡**: æŒæ¡ Vue ç»„ä»¶çš„å¸¸è§è®¾è®¡æ¨¡å¼ï¼Œå­¦ä¼šæ„å»ºå¯å¤ç”¨ã€å¯ç»´æŠ¤çš„ç»„ä»¶æ¶æ„ã€‚  
> **å®è·µåŸºåœ°**: [ğŸ§ª ç»„ä»¶é€šä¿¡å®éªŒå®¤](../../../)

## 1. ä¸ºä»€ä¹ˆéœ€è¦è®¾è®¡æ¨¡å¼ï¼Ÿ

éšç€åº”ç”¨å˜å¤§ï¼Œç»„ä»¶ä¼šè¶Šæ¥è¶Šå¤šï¼Œå…³ç³»è¶Šæ¥è¶Šå¤æ‚ã€‚å¥½çš„è®¾è®¡æ¨¡å¼èƒ½å¸®åŠ©æˆ‘ä»¬ï¼š

- ğŸ”„ **å¤ç”¨ä»£ç ** - é¿å…é‡å¤
- ğŸ§© **è§£è€¦ç»„ä»¶** - é™ä½ä¾èµ–
- ğŸ“– **æé«˜å¯è¯»æ€§** - æ˜“äºç†è§£
- ğŸ”§ **ä¾¿äºç»´æŠ¤** - æ–¹ä¾¿ä¿®æ”¹

---

## 2. å®¹å™¨ç»„ä»¶ vs å±•ç¤ºç»„ä»¶

### 2.1 å±•ç¤ºç»„ä»¶ï¼ˆPresentational Componentsï¼‰

åªè´Ÿè´£**å¦‚ä½•æ˜¾ç¤º**ï¼Œä¸åŒ…å«ä¸šåŠ¡é€»è¾‘ï¼š

```vue
<!-- ArticleCard.vue - å±•ç¤ºç»„ä»¶ -->
<template>
  <div class="card">
    <h3>{{ title }}</h3>
    <p>{{ summary }}</p>
    <span>{{ date }}</span>
  </div>
</template>

<script setup>
// åªæ¥æ”¶ propsï¼Œä¸å¤„ç†é€»è¾‘
defineProps<{
  title: string
  summary: string
  date: string
}>()
</script>
```

**ç‰¹ç‚¹**ï¼š
- é€šè¿‡ props æ¥æ”¶æ•°æ®
- é€šè¿‡ emit å‘ä¸Šä¼ é€’äº‹ä»¶
- æ²¡æœ‰å‰¯ä½œç”¨ï¼ˆä¸è°ƒç”¨ APIï¼‰
- å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹å¤ç”¨

### 2.2 å®¹å™¨ç»„ä»¶ï¼ˆContainer Componentsï¼‰

è´Ÿè´£**åšä»€ä¹ˆ**ï¼Œå¤„ç†æ•°æ®å’Œä¸šåŠ¡é€»è¾‘ï¼š

```vue
<!-- ArticleList.vue - å®¹å™¨ç»„ä»¶ -->
<template>
  <div>
    <ArticleCard
      v-for="article in articles"
      :key="article.id"
      :title="article.title"
      :summary="article.summary"
      :date="article.createdAt"
      @click="handleSelect(article)"
    />
  </div>
</template>

<script setup>
import { ref, onMounted } from 'vue'
import ArticleCard from './ArticleCard.vue'

const articles = ref([])

// å®¹å™¨ç»„ä»¶è´Ÿè´£æ•°æ®è·å–
onMounted(async () => {
  articles.value = await fetchArticles()
})

const handleSelect = (article) => {
  // å¤„ç†ä¸šåŠ¡é€»è¾‘
}
</script>
```

---

## 3. å¤åˆç»„ä»¶æ¨¡å¼ï¼ˆCompound Componentsï¼‰

å°†ç›¸å…³ç»„ä»¶ç»„åˆåœ¨ä¸€èµ·ï¼Œå…±äº«éšå¼çŠ¶æ€ã€‚

### æ¨±èŠ±ç¬”è®°ä¸­çš„æ¡ˆä¾‹ï¼šMusicPlayer

```vue
<!-- çˆ¶ç»„ä»¶æä¾›ä¸Šä¸‹æ–‡ -->
<MusicPlayer>
  <MusicPlayer.Cover />
  <MusicPlayer.Title />
  <MusicPlayer.Controls />
  <MusicPlayer.Progress />
</MusicPlayer>
```

å®ç°æ–¹å¼ï¼ˆä½¿ç”¨ provide/injectï¼‰ï¼š

```vue
<!-- MusicPlayer.vue -->
<script setup>
import { provide, ref } from 'vue'

const currentTrack = ref(null)
const isPlaying = ref(false)

// æä¾›çŠ¶æ€ç»™å­ç»„ä»¶
provide('music-player', {
  currentTrack,
  isPlaying,
  play: () => { isPlaying.value = true },
  pause: () => { isPlaying.value = false }
})
</script>

<template>
  <div class="music-player">
    <slot />
  </div>
</template>
```

```vue
<!-- MusicPlayer.Controls.vue -->
<script setup>
import { inject } from 'vue'

const { isPlaying, play, pause } = inject('music-player')
</script>

<template>
  <button @click="isPlaying ? pause() : play()">
    {{ isPlaying ? 'â¸ï¸' : 'â–¶ï¸' }}
  </button>
</template>
```

---

## 4. æ¸²æŸ“ä»£ç†æ¨¡å¼ï¼ˆRenderless Componentsï¼‰

ç»„ä»¶åªæä¾›é€»è¾‘ï¼Œä¸æ¸²æŸ“ä»»ä½• UIï¼Œé€šè¿‡ä½œç”¨åŸŸæ’æ§½æš´éœ²æ•°æ®ï¼š

```vue
<!-- MouseTracker.vue - æ— æ¸²æŸ“ç»„ä»¶ -->
<script setup>
import { ref, onMounted, onUnmounted } from 'vue'

const x = ref(0)
const y = ref(0)

const update = (e) => {
  x.value = e.pageX
  y.value = e.pageY
}

onMounted(() => window.addEventListener('mousemove', update))
onUnmounted(() => window.removeEventListener('mousemove', update))
</script>

<template>
  <!-- é€šè¿‡ä½œç”¨åŸŸæ’æ§½æš´éœ²æ•°æ® -->
  <slot :x="x" :y="y" />
</template>
```

ä½¿ç”¨æ–¹å¼ï¼š

```vue
<MouseTracker v-slot="{ x, y }">
  <div>é¼ æ ‡ä½ç½®: {{ x }}, {{ y }}</div>
</MouseTracker>
```

> ğŸ’¡ **ç°ä»£æ›¿ä»£**: Vue 3 ä¸­ï¼ŒComposables å¯ä»¥æ›´ä¼˜é›…åœ°å®ç°ç›¸åŒåŠŸèƒ½ã€‚

---

## 5. é«˜é˜¶ç»„ä»¶æ¨¡å¼ï¼ˆHOC - è¾ƒå°‘ä½¿ç”¨ï¼‰

åŒ…è£…å¦ä¸€ä¸ªç»„ä»¶ï¼Œæ·»åŠ é¢å¤–åŠŸèƒ½ï¼š

```javascript
// withLoading.js
import { h, ref } from 'vue'

export function withLoading(WrappedComponent) {
  return {
    setup(props, { slots }) {
      const loading = ref(true)
      
      // æ¨¡æ‹ŸåŠ è½½
      setTimeout(() => { loading.value = false }, 1000)
      
      return () => {
        if (loading.value) {
          return h('div', 'Loading...')
        }
        return h(WrappedComponent, props, slots)
      }
    }
  }
}
```

> ğŸ“ **æ³¨æ„**: åœ¨ Vue 3 ä¸­ï¼ŒComposables é€šå¸¸æ¯” HOC æ›´æ¨èã€‚

---

## 6. Provider æ¨¡å¼

ä½¿ç”¨ provide/inject åœ¨ç»„ä»¶æ ‘ä¸­å…±äº«çŠ¶æ€ï¼š

```vue
<!-- ThemeProvider.vue -->
<script setup>
import { provide, ref, computed } from 'vue'

const isDark = ref(false)

const theme = computed(() => ({
  colors: {
    primary: isDark.value ? '#f472b6' : '#ec4899',
    background: isDark.value ? '#1f2937' : '#ffffff',
    text: isDark.value ? '#f3f4f6' : '#111827'
  }
}))

const toggleTheme = () => {
  isDark.value = !isDark.value
}

provide('theme', { theme, toggleTheme, isDark })
</script>

<template>
  <div :style="{ backgroundColor: theme.colors.background }">
    <slot />
  </div>
</template>
```

ä»»æ„æ·±åº¦çš„å­ç»„ä»¶éƒ½å¯ä»¥ä½¿ç”¨ï¼š

```vue
<script setup>
const { theme, toggleTheme } = inject('theme')
</script>
```

---

## 7. æ¨±èŠ±ç¬”è®°ä¸­çš„è®¾è®¡æ¨¡å¼å®è·µ

### 7.1 AppSidebar - å®¹å™¨ + å±•ç¤ºåˆ†ç¦»

```
AppSidebar (å®¹å™¨)
â”œâ”€â”€ FileTree (å±•ç¤º)
â”œâ”€â”€ FolderView (å±•ç¤º)  
â””â”€â”€ SearchModal (å±•ç¤º)
```

### 7.2 LabDashboard - å¤åˆç»„ä»¶

```
LabDashboard (å®¹å™¨)
â”œâ”€â”€ Stage 1 Labs
â”‚   â”œâ”€â”€ LabHtml
â”‚   â””â”€â”€ LabCodeEvolution
â”œâ”€â”€ Stage 2 Labs
â”‚   â””â”€â”€ LabJsBasics
â””â”€â”€ ...
```

### 7.3 Store æ¨¡å¼ (Pinia)

```javascript
// å…¨å±€çŠ¶æ€é›†ä¸­ç®¡ç†
const appStore = useAppStore()  // åº”ç”¨çŠ¶æ€
const musicStore = useMusicStore()  // éŸ³ä¹çŠ¶æ€
const articleStore = useArticleStore()  // æ–‡ç« çŠ¶æ€
```

---

## 8. æœ€ä½³å®è·µæ€»ç»“

| æ¨¡å¼ | é€‚ç”¨åœºæ™¯ | å®ç°æ–¹å¼ |
|------|----------|----------|
| å®¹å™¨/å±•ç¤º | åˆ†ç¦»é€»è¾‘å’Œ UI | Props + Emit |
| å¤åˆç»„ä»¶ | ç›¸å…³ç»„ä»¶å…±äº«çŠ¶æ€ | Provide/Inject |
| æ— æ¸²æŸ“ç»„ä»¶ | é€»è¾‘å¤ç”¨ | ä½œç”¨åŸŸæ’æ§½ |
| Provider | è·¨å±‚çº§çŠ¶æ€å…±äº« | Provide/Inject |
| Store | å…¨å±€çŠ¶æ€ç®¡ç† | Pinia |

### é€‰æ‹©å»ºè®®

1. **ç®€å•çŠ¶æ€ä¼ é€’** â†’ Props/Emit
2. **è·¨å¤šå±‚ç»„ä»¶** â†’ Provide/Inject
3. **å…¨å±€çŠ¶æ€** â†’ Pinia
4. **é€»è¾‘å¤ç”¨** â†’ Composablesï¼ˆé¦–é€‰ï¼‰
5. **UI å¤ç”¨** â†’ å±•ç¤ºç»„ä»¶ + æ’æ§½

---

## 9. ç»ƒä¹ ä»»åŠ¡

1. å°†ä¸€ä¸ªç°æœ‰ç»„ä»¶æ‹†åˆ†ä¸ºå®¹å™¨ç»„ä»¶å’Œå±•ç¤ºç»„ä»¶
2. ä½¿ç”¨ provide/inject å®ç°ä¸€ä¸ªä¸»é¢˜åˆ‡æ¢ç³»ç»Ÿ
3. åˆ›å»ºä¸€ä¸ªæ— æ¸²æŸ“çš„ `useCountdown` ç»„ä»¶

---

## å‚è€ƒèµ„æº

- [Vue å®˜æ–¹ - ç»„ä»¶åŸºç¡€](https://cn.vuejs.org/guide/essentials/component-basics.html)
- [Vue è®¾è®¡æ¨¡å¼](https://www.patterns.dev/vue)
- æ¨±èŠ±ç¬”è®°æºç : `components/` ç›®å½•
